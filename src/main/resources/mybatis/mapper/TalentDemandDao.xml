<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.busniess.dao.TalentDemandDao">

    <!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.example.busniess.entity.TalentDemandEntity" id="baseMap">
        <result property="id" column="id"/>
        <result property="userName" column="user_name"/>
        <result property="title" column="title"/>
        <result property="content" column="content"/>
        <result property="engagedIndustry" column="engaged_industry"/>
        <result property="engagedIndustryDetail" column="engaged_industry_detail"/>
        <result property="industryExperience" column="industry_experience"/>
        <result property="technologyScope" column="technology_scope"/>
        <result property="researchDirection" column="research_direction"/>
        <result property="demandsType" column="demands_type"/>
        <result property="peopleNum" column="people_num"/>
        <result property="remuneration" column="remuneration"/>
        <result property="salary" column="salary"/>
        <result property="contact" column="contact"/>
        <result property="phoneNum" column="phone_num"/>
        <result property="status" column="status"/>
        <result property="approvalStatus" column="approval_status"/>
        <result property="approvalOpinion" column="approval_opinion"/>
        <result property="createTime" column="create_time"/>
        <result property="updateTime" column="update_time"/>
        <result property="companyName" column="companyName"/>
        <result property="province" column="province"/>
        <result property="city" column="city"/>
        <result property="district" column="district"/>
    </resultMap>

    <sql id="columnNames">
                d.id,d.user_name,d.title,d.content,d.engaged_industry,d.engaged_industry_detail,d.industry_experience,d.technology_scope,d.research_direction,
                d.demands_type,d.people_num,d.remuneration,d.salary,d.contact,d.phone_num,d.status,d.approval_status,d.approval_opinion,d.create_time,d.update_time,
                b.firmName companyName,b.country province,b.city,b.district
            </sql>

    <sql id="addColumnNames">
                user_name,
                title,
                content,
                engaged_industry,
                engaged_industry_detail,
                industry_experience,
                technology_scope,
                research_direction,
                demands_type,
                people_num,
                remuneration,
                salary,
                contact,
                phone_num,
                create_time
            </sql>

    <sql id="attrnames">
                #{userName},
                #{title},
                #{content},
                #{engagedIndustry},
                #{engagedIndustryDetail},
                #{industryExperience},
                #{technologyScope},
                #{researchDirection},
                #{demandsType},
                #{peopleNum},
                #{remuneration},
                #{salary},
                #{contact},
                #{phoneNum},
                #{createTime}
            </sql>

    <insert id="add" parameterType="com.example.busniess.entity.TalentDemandEntity">
        insert into talent_demand (<include refid="addColumnNames"></include>)
        values (<include refid="attrnames"></include>);
    </insert>

    <select id="selectById" parameterType="Integer" resultMap="baseMap">
        select <include refid="columnNames"></include>
        from talent_demand d ,businesscenter b
        where d.user_name = b.uname and d.id=#{id}
    </select>

    <update id="updateById" parameterType="com.example.busniess.entity.TalentDemandEntity">
        update talent_demand
        <set>
            <if test="title!=null and title!=''">
                title=#{title},
            </if>
            <if test="content!=null and content!=''">
                content=#{content},
            </if>
            <if test="engagedIndustry!=null and engagedIndustry!=''">
                engaged_industry=#{engagedIndustry},
            </if>
            <if test="engagedIndustryDetail!=null and engagedIndustryDetail!=''">
                engaged_industry_detail=#{engagedIndustryDetail},
            </if>
            <if test="industryExperience!=null and industryExperience!=''">
                industry_experience=#{industryExperience},
            </if>
            <if test="technologyScope!=null and technologyScope!=''">
                technology_scope=#{technologyScope},
            </if>
            <if test="researchDirection!=null and researchDirection!=''">
                research_direction=#{researchDirection},
            </if>
            <if test="demandsType!=null and demandsType!=''">
                demands_type=#{demandsType},
            </if>
            <if test="peopleNum!=null and peopleNum!=''">
                people_num=#{peopleNum},
            </if>
            <if test="remuneration!=null and remuneration!=''">
                remuneration=#{remuneration},
            </if>
            <if test="salary!=null and salary!=''">
                salary=#{salary},
            </if>
            <if test="contact!=null and contact!=''">
                contact=#{contact},
            </if>
            <if test="phoneNum!=null and phoneNum!=''">
                phone_num=#{phoneNum},
            </if>
            <if test="status!=null and status!=''">
                status=#{status},
            </if>
            <if test="approvalStatus!=null and approvalStatus!=''">
                approval_status=#{approvalStatus},
            </if>
            <if test="approvalOpinion!=null and approvalOpinion!=''">
                approval_opinion=#{approvalOpinion},
            </if>
            <if test="createTime!=null and createTime!=''">
                create_time=#{createTime},
            </if>
            <if test="updateTime!=null and updateTime!=''">
                update_time=#{updateTime},
            </if>
        </set>
        where id = #{id}
    </update>

    <delete id="realDeleteById" parameterType="Integer">
        delete from talent_demand where id = #{id};
    </delete>

    <select id="search" resultMap="baseMap" parameterType="com.example.busniess.entity.TalentDemandEntity">
        select <include refid="columnNames"></include> from talent_demand d,businesscenter b
        <where>
            d.user_name = b.uname
            <if test="userName!=null and userName!=''">
                and d.user_name=#{userName}
            </if>
            <if test="engagedIndustry!=null and engagedIndustry!=''">
                and d.engaged_industry=#{engagedIndustry}
            </if>
            <if test="engagedIndustryDetail!=null and engagedIndustryDetail!=''">
                and d.engaged_industry_detail=#{engagedIndustryDetail}
            </if>
            <if test="industryExperience!=null and industryExperience!=''">
                and d.industry_experience=#{industryExperience}
            </if>
            <if test="technologyScope!=null and technologyScope!=''">
                and d.technology_scope=#{technologyScope}
            </if>
            <if test="researchDirection!=null and researchDirection!=''">
                and d.research_direction=#{researchDirection}
            </if>
            <if test="demandsType!=null and demandsType!=''">
                and d.demands_type=#{demandsType}
            </if>
            <if test="status>=0 or status!=null and status!=''">
                and d.status=#{status}
            </if>
            <if test="approvalStatus!=null and approvalStatus!=''">
                and d.approval_status=#{approvalStatus}
            </if>
            <if test="companyName!=null and companyName!=''">
                and b.firmName=#{companyName}
            </if>
            <if test="keyWord!=null and keyWord!=''">
                and (d.`engaged_industry` like CONCAT('%',#{keyWord},'%') or d.`engaged_industry_detail` like
                CONCAT('%',#{keyWord},'%') or d.`title` like CONCAT('%',#{keyWord},'%'))
            </if>
        </where>
    </select>
</mapper>