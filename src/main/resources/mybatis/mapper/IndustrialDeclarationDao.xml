<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.busniess.dao.IndustrialDeclarationDao">

    <resultMap type="com.example.busniess.entity.IndustrialDeclarationEntity" id="industrialDeclarationMap">
        <result property="id" column="id"/>
        <result property="declarationType" column="declaration_type"/>
        <result property="isNew" column="is_new"/>
        <result property="declarationIndustry" column="declaration_industry"/>
        <result property="industryTypeDetail" column="industry_type_detail"/>
        <result property="projectType" column="project_type"/>
        <result property="projectTypeDetail" column="project_type_detail"/>
        <result property="companyName" column="company_name"/>
        <result property="projectContent" column="project_content"/>
        <result property="city" column="city"/>
        <result property="district" column="district"/>
        <result property="status" column="status"/>
        <result property="approvalStatus" column="approval_status"/>
        <result property="approvalOpinion" column="approval_opinion"/>
        <result property="createTime" column="create_time"/>
        <result property="updateTime" column="update_time"/>
        <result property="startDate" column="start_date"/>
        <result property="endDate" column="end_date"/>
        <result property="totalInvestment" column="total_investment"/>
    </resultMap>

    <select id="selectById" resultMap="industrialDeclarationMap" parameterType="Integer">
        select id,declaration_type,project_type,company_name,project_name,status,approval_status,create_time from industrial_declaration where status != '44' and id=#{id};
    </select>

    <select id="selectAll" resultMap="industrialDeclarationMap">
        select id,declaration_type,project_type,company_name,project_name,status,approval_status,create_time from industrial_declaration where status != '44';
    </select>

    <select id="search" resultMap="industrialDeclarationMap" parameterType="com.example.busniess.entity.IndustrialDeclarationEntity">
        select id,declaration_type,project_type,company_name,project_name,status,approval_status,create_time from industrial_declaration
        where status != '44' and status !='3'
        <if test="declarationType!=null and declarationType!=''">
            and `declaration_type` = #{declarationType}
        </if>
        <if test="projectType!=null and projectType!=''">
            and `project_type` = #{projectType}
        </if>
        <if test="declarationIndustry!=null and declarationIndustry!=''">
            and `declaration_industry` = #{declarationIndustry}
        </if>
        <if test="companyName!=null and companyName!=''">
            and `company_name` = #{companyName}
        </if>
        <if test="declarationYear!=null and declarationYear!=''">
            and year(`create_time`) = #{declarationYear}
        </if>
        <if test="approvalStatus!=null and approvalStatus!=''">
            and `approval_status` = #{approvalStatus}
        </if>
    </select>

    <insert id="add" parameterType="com.example.busniess.entity.IndustrialDeclarationEntity" useGeneratedKeys="true" keyProperty="id">
        insert into industrial_declaration(declaration_type,is_new,declaration_industry,industry_type_detail,project_type,project_type_detail,company_name,project_name,project_content,city,district,start_date,end_date,total_investment)
        value (#{declarationType},#{isNew},#{declarationIndustry},#{industryTypeDetail},#{projectType},#{projectTypeDetail},#{companyName},#{projectName},#{projectContent},#{city},#{district},#{startDate},#{endDate},#{totalInvestment});
    </insert>

    <update id="update" parameterType="com.example.busniess.entity.IndustrialDeclarationEntity">
        update industrial_declaration
        <set>
            <if test="declarationType!=null and declarationType!=''">
                declaration_type=#{declarationType},
            </if>
            <if test="isNew!=null and isNew!=''">
                is_new=#{isNew},
            </if>
            <if test="declarationIndustry!=null and declarationIndustry!=''">
                declaration_industry=#{declarationIndustry},
            </if>
            <if test="industryTypeDetail!=null and industryTypeDetail!=''">
                industry_type_detail=#{industryTypeDetail},
            </if>
            <if test="projectType!=null and projectType!=''">
                project_type = #{projectType},
            </if>
            <if test="projectTypeDetail!=null and projectTypeDetail!=''">
                project_type_detail = #{projectTypeDetail},
            </if>
            <if test="companyName!=null and companyName!=''">
                company_name=#{companyName},
            </if>
            <if test="projectName!=null and projectName!=''">
                project_name=#{projectName},
            </if>
            <if test="projectContent!=null and projectContent!=''">
                project_content=#{projectContent},
            </if>
            <if test="city!=null and city!=''">
                city=#{city},
            </if>
            <if test="district!=null and district!=''">
                district=#{district},
            </if>
            <if test="status!=null and status!=''">
                status=#{status},
            </if>
            <if test="approvalStatus!=null and approvalStatus!=''">
                approval_status=#{approvalStatus},
            </if>
            <if test="approvalOpinion!=null and approvalOpinion!=''">
                approval_opinion=#{approvalOpinion},
            </if>
            <if test="startDate!=null and startDate!=''">
                start_date=#{startDate},
            </if>
            <if test="endDate!=null and endDate!=''">
                end_date=#{endDate},
            </if>
            <if test="totalInvestment!=null and totalInvestment!=''">
                total_investment=#{totalInvestment},
            </if>
        </set>
        where id = #{id}
    </update>
</mapper>